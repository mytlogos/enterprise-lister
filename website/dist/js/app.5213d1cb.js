(function(e){function t(t){for(var r,i,a=t[0],u=t[1],d=t[2],l=0,c=[];l<a.length;l++)i=a[l],s[i]&&c.push(s[i][0]),s[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);f&&f(t);while(c.length)c.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var a=n[i];0!==s[a]&&(r=!1)}r&&(o.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},i={app:0},s={app:0},o=[];function a(e){return u.p+"js/"+({add:"add",lists:"lists",login:"login",news:"news",read:"read",settings:"settings"}[e]||e)+"."+{add:"00d268d4",lists:"21e57323",login:"9be6e1cf",news:"6c2a7518",read:"3264344a",settings:"25553c20"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={lists:1,news:1,settings:1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=new Promise(function(t,n){for(var r="css/"+({add:"add",lists:"lists",login:"login",news:"news",read:"read",settings:"settings"}[e]||e)+"."+{add:"31d6cfe0",lists:"bf03d0db",login:"31d6cfe0",news:"f1a119ae",read:"31d6cfe0",settings:"5e767fdc"}[e]+".css",s=u.p+r,o=document.getElementsByTagName("link"),a=0;a<o.length;a++){var d=o[a],l=d.getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(l===r||l===s))return t()}var c=document.getElementsByTagName("style");for(a=0;a<c.length;a++){d=c[a],l=d.getAttribute("data-href");if(l===r||l===s)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var r=t&&t.target&&t.target.src||s,o=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");o.request=r,delete i[e],f.parentNode.removeChild(f),n(o)},f.href=s;var h=document.getElementsByTagName("head")[0];h.appendChild(f)}).then(function(){i[e]=0}));var r=s[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise(function(t,n){r=s[e]=[t,n]});t.push(r[2]=o);var d,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=a(e),d=function(t){l.onerror=l.onload=null,clearTimeout(c);var n=s[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+r+": "+i+")");o.type=r,o.request=i,n[1](o)}s[e]=void 0}};var c=setTimeout(function(){d({type:"timeout",target:l})},12e4);l.onerror=l.onload=d,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/",u.oe=function(e){throw console.error(e),e};var d=window["webpackJsonp"]=window["webpackJsonp"]||[],l=d.push.bind(d);d.push=t,d=d.slice();for(var c=0;c<d.length;c++)t(d[c]);var f=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0a2a":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAQ3QAAEN0BC6uduQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAOvSURBVEiJrZZNSGNXFMd/z0Qj2imiEBCLMSNoC5bkRcGuKpYaRGVm0cWUEQS7r4m0he5kUBE3Youguy7bMlPRUlxI0IyjWKHRdkZtkXFaP/oxM1Yk72mik7zTRV7kmSZtCv3D3bxz/v9z7z0f90FulAMfADvAIuC02Jzmtx3TpzyXSEGO7zeAQ4/HczscDv+kqmoJcAe4bq47jY2NJabtNnBocvLGvWAwOCMiCRERXde3q6urDwABxOVyHei6/qOkkAwGgzPAvWxC9hwB7m9tbb0H2ABKS0tf29vbAzg37a9YfAs2Nzergc+yCWW7omvAu62trVoWm8NcV9DS0qIDt0xuVtwE7gLvAyudnZ0REdHFAsMwjjRN2z45OYkYhnHFJiJ6V1fXOrBiatw1NQGoAM6CweCs3+/fGBkZeSAip5dMXX/U3d29arfbXwBHwJ92u/2it7d3NRaLPbYEOR0dHV32+/0bwWBwFjjDrK6PfD7fd+mEWrG7u7tcVFSkA2NAjeXE14FPioqKtP39/bVMnogkVFWNkCphdsLh8Gymx+np6bbD4dCAd3LdK3CruLg4Go/HdzL54XB4llSfsKiq6pqmaY+sDj09PcvAp/8gnsZUIBBYsXI1TXvo8/m+JdWMOIGpurq6Q0tCo3a7PQ68mkeA1wsLC0+teautrT0EJrF0v7ugoEBEJCkiEovFHgOxPMQhVern8Xg8nfCkoiiCmbPLPjAMA1KdiqIoaZuSRwAFKLDZbOn+METkioMTmHS73QfWunY4HFHAl0eAN0pKSk5EJJ4mu1yuA2DK1Gaxubl5LRaLPbEmKhAILACf5xHgq+Hh4XBGkn9oamq6TPJOKBSaziyzi4uLJ2VlZUeYtZwDH1dWVj5PJBK/Z/IXFhZmMMv0Q4/HExGRF5lOx8fH606n8zkwC7wFvGyut4Fvqqqqnkaj0YeZPBFJeL3e9fTmKoCzvr6+mfb29u8HBweXrCWXSCR+GxsbWygvL3+KOa4rKir+mJiYWEwmk88spa0NDAzcb2tr2+jv7/+a1KioSB/1Jql53keOYScikkwmnxmGcZRlx+cdHR05h10mrgErQ0NDD7IIZcX4+PiqKf63cZ3tPdCAL5aWll7KYkua6wrm5uaKgS9N7r8GAGipr6//BTAAdF3frKmpOVQUxaYois3tdv+q6/q26Xvhdrt/Bt7MoZUVN4AzVVUjoVBo2uv1rpFqnPSjP+n1etfm5+enGxoaIqQS+p8effifflv+AvxZ+F4L1UyZAAAAAElFTkSuQmCC"},c9cb:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal"},[n("div",{staticClass:"modal-header"},[n("span",[e._t("title")],2)]),e._t("text"),n("form",[e._t("input"),n("div",{staticClass:"button"},[n("button",{staticClass:"finish",attrs:{type:"button"},on:{click:function(t){e.$emit("finish")}}},[e._t("finish",[e._v("Save")])],2)]),e._t("after"),n("div",{staticClass:"error"})],2)],2)},i=[],s=(n("cadf"),n("551c"),n("097d"),n("f5ef")),o={props:{error:String},mounted:function(){var e=this;document.addEventListener("click",function(t){!e.$el.contains(t.target)&&e.show&&(t.stopImmediatePropagation(),t.preventDefault(),e.close())},{capture:!0})},methods:{close:function(){Object(s["a"])("reset:modal")}},name:"modal"},a=o,u=n("2877"),d=Object(u["a"])(a,r,i,!1,null,null,null);t["a"]=d.exports},cd49:function(e,t,n){"use strict";n.r(t);var r=n("5d73"),i=n.n(r),s=n("a745"),o=n.n(s),a=n("75fc"),u=(n("7514"),n("20d6"),n("ac6a"),n("7f7f"),n("cadf"),n("551c"),n("097d"),n("2b0e")),d=n("8c4f");u["a"].use(d["a"]);var l=new d["a"]({mode:"history",base:"/",routes:[{path:"/",redirect:function(e){return"/"+(e.query.redirect||"home")}},{path:"/home",component:function(){return n.e("lists").then(n.bind(null,"bb51"))}},{path:"/list",component:function(){return n.e("lists").then(n.bind(null,"ef9d"))}},{path:"/news",component:function(){return n.e("news").then(n.bind(null,"a2f9"))}},{path:"/settings",component:function(){return n.e("settings").then(n.bind(null,"26d3"))}},{path:"/addMedium",component:function(){return n.e("add").then(n.bind(null,"6937"))}},{path:"/addList",component:function(){return n.e("add").then(n.bind(null,"7431"))}},{path:"/register",component:function(){return n.e("login").then(n.bind(null,"73cf"))}},{path:"/login",component:function(){return n.e("login").then(n.bind(null,"a55b"))}},{path:"/readHistory",component:function(){return n.e("read").then(n.bind(null,"19c9"))}},{path:"*",component:function(){return n.e("read").then(n.bind(null,"7af1"))}}]}),c=l,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("app-header",{attrs:{"logged-in":e.loggedIn,name:e.name,"show-lists":e.showLists,"show-releases":e.showReleases,"show-settings":e.showSettings}}),n("main",[n("router-view",{attrs:{lists:e.allLists,news:e.news,columns:e.columns,media:e.displayMedia,externalUser:e.externalUser}})],1)],1)},h=[],p=n("b6d0"),m=n.n(p),g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",[r("nav",{attrs:{id:"navbar"}},[e.loggedIn?[r("span",[e._v(e._s(e.name))]),r("router-link",{staticClass:"btn",attrs:{to:"addMedium",tag:"button"}},[e._v("Add Medium")]),r("router-link",{staticClass:"btn",attrs:{to:"addList",tag:"button"}},[e._v("Add List")]),r("router-link",{staticClass:"btn",attrs:{to:"news",tag:"button"}},[e._v("News")]),r("router-link",{staticClass:"btn",attrs:{to:"readHistory",tag:"button"}},[e._v("Read History")]),r("router-link",{staticClass:"btn",attrs:{to:"list",tag:"button"}},[e._v("Lists")]),r("router-link",{staticClass:"btn",attrs:{to:"settings",tag:"button"}},[r("img",{attrs:{alt:"Settings",src:n("0a2a")}})]),r("router-link",{staticClass:"btn",attrs:{to:"/",tag:"button"},on:{click:e.logout}},[e._v("Logout")])]:[r("router-link",{staticClass:"btn",attrs:{to:"register",tag:"button"}},[e._v("Register")]),r("router-link",{staticClass:"btn",attrs:{to:"login",tag:"button"}},[e._v("Login")])]],2)])},v=[],w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn",on:{click:function(t){e.emit(e.event)}}},[e._v(e._s(e.name))])},b=[],M=n("f5ef"),y={props:{event:String,name:String},methods:{logout:function(e){console.log("emitting"),Object(M["a"])(e)}},name:"app-header"},A=y,x=n("2877"),E=Object(x["a"])(A,w,b,!1,null,null,null),k=E.exports,j={components:{simpleButton:k},props:{loggedIn:Boolean,showLists:Boolean,showSettings:Boolean,showReleases:Boolean,name:String},methods:{logout:function(){Object(M["a"])("do:logout")}},name:"app-header"},L=j,O=Object(x["a"])(L,g,v,!1,null,null,null),S=O.exports,U=(n("6b54"),n("f499")),N=n.n(U),C=n("5176"),P=n.n(C),I=n("795b"),_=n.n(I),q=(n("6762"),n("2fdb"),n("7618")),B=n("a4bb"),R=n.n(B),T={post:"POST",get:"GET",put:"PUT",delete:"DELETE"},D={api:{get:!0,login:{post:!0},register:{post:!0},user:{put:!0,delete:!0,logout:{post:!0},lists:{get:!0},medium:{get:!0,post:!0,put:!0,part:{get:!0,post:!0,put:!0,delete:!0,episode:{get:!0,post:!0,put:!0,delete:!0,progress:{get:!0,post:!0,put:!0,delete:!0}}}},externalUser:{get:!0,post:!0,delete:!0},list:{get:!0,post:!0,put:!0,delete:!0,medium:{get:!0,post:!0,put:!0,delete:!0}},news:{get:!0}}}},H=function(){var e={},t={},n={},r={};function s(r){var s=t[r],o=!0,a=!1,u=void 0;try{for(var d,l=i()(s);!(o=(d=l.next()).done);o=!0){var c=d.value,f=n[c].reduce(function(e,t){return t.length>e.length?e:t});f.length&&(e[c]=f)}}catch(h){a=!0,u=h}finally{try{o||null==l.return||l.return()}finally{if(a)throw u}}}(function e(i){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i&&s.push(i);for(var d=R()(o),l=0;l<d.length;l++){var c=d[l],f=o[c],h=n[c];h||(h=n[c]=[]),h.push(Object(a["a"])(s)),t[c]||(t[c]=[]),i&&t[c].push(i),"object"===Object(q["a"])(f)?e(c,s,f,u++):r[c]=!0}s.pop()})();for(var o=R()(r),u=0;u<o.length;u++){var d=o[u];s(d)}var l,c=[];return new Proxy({},{get:function(i,s,o){var u=t[s];if(l){if(!u.includes(l))throw Error("path section '".concat(s,"' is not part of the rest api"));c.push(l)}else{var d=e[s];if(d)c.push.apply(c,Object(a["a"])(d));else if(u.length)throw Error("path section '".concat(s,"' is not part of the rest api"))}if(s in r){var f=c.join("/"),h=T[s];if(!h)throw Error("unknown method: '".concat(s,"'"));return c.length=0,l=null,new Proxy({path:f,method:h},{get:function(e,t){if(("path"!==t||"method"!==t)&&t in n)throw Error("'".concat(String(t),"' is not a property of object"));return e[t]}})}return l=s,o}})}(),F={user:null,get loggedIn(){return this.user&&Boolean(this.user.uuid)},isLoggedIn:function(){return this.queryServer(H.api.get)},login:function(e,t){return F.loggedIn?_.a.reject():e&&t?this.queryServer(H.login.post,{userName:e,pw:t}):_.a.reject()},register:function(e,t,n){return F.loggedIn?_.a.reject():t!==n?_.a.reject():this.queryServer(H.register.post,{userName:e,pw:t})},logout:function(){return this.queryServer(H.logout.post).then(function(e){return e.loggedOut})},addExternalUser:function(e){return this.queryServer(H.externalUser.post,{externalUser:e})},deleteExternalUser:function(e){return this.queryServer(H.externalUser.delete,{externalUuid:e})},createList:function(e){return this.queryServer(H.list.post,{list:e}).then(function(t){return P()(e,t)})},updateList:function(e){return this.queryServer(H.list.put,{list:e})},deleteList:function(e){return this.queryServer(H.list.delete,{listId:e}).then(function(e){return e.error?_.a.reject(e.error):e})},createMedium:function(e){return this.queryServer(H.medium.post,{medium:e})},getMedia:function(e){return o()(e)&&!e.length?_.a.reject():this.queryServer(H.medium.get,{mediumId:e})},updateMedium:function(e){return _.a.resolve()},deleteMedium:function(e){return _.a.resolve()},getNews:function(e,t){return this.queryServer(H.news.get,{from:e,to:t})},queryServer:function(e,t){var n=e.path,r=e.method;if(n.includes("user")){if(!this.user||!this.user.uuid)throw Error("cannot send user message if no user is logged in");t||(t={}),t.uuid=this.user.uuid,t.session=this.user.session}var i={method:r,headers:{"Content-Type":"application/json; charset=utf-8"}},s=new URL("".concat(window.location.origin,"/").concat(n));return t&&(r===T.get?R()(t).forEach(function(e){return s.searchParams.append(e,t[e])}):i.body=N()(t)),fetch(s.toString(),i).then(function(e){return e.json()}).then(function(e){return e.error?_.a.reject(e.error):e})}},z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{attrs:{error:e.error,show:e.show},on:{finish:function(t){e.send()}}},[n("template",{slot:"title"},[e._v("Add Reading List")]),n("template",{slot:"input"},[n("div",{staticClass:"input-name"},[n("label",[e._v("\n                Name:\n                "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{name:"name",required:"",title:"List Name",type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})])]),n("div",{staticClass:"input-medium"},[n("label",[e._v("Medium:")]),e._l(e.mediaTypes,function(t){return n("span",{staticClass:"medium-check-container"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"type.checked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{change:function(n){var r=t.checked,i=n.target,s=!!i.checked;if(Array.isArray(r)){var o=null,a=e._i(r,o);i.checked?a<0&&e.$set(t,"checked",r.concat([o])):a>-1&&e.$set(t,"checked",r.slice(0,a).concat(r.slice(a+1)))}else e.$set(t,"checked",s)}}}),e._v("\n                    "+e._s(t.name)+"\n                ")])])})],2)]),n("template",{slot:"finish"},[e._v("Add List")])],2)},V=[],G=n("c9cb"),K={components:{modal:G["a"]},data:function(){return{mediaTypes:[{name:"Text",checked:!1,value:1},{name:"Audio",checked:!1,value:2},{name:"Video",checked:!1,value:4},{name:"Image",checked:!1,value:8}],name:""}},props:{show:Boolean,error:String},methods:{send:function(){var e=0;this.mediaTypes.forEach(function(t){t.checked&&(e|=t.value)}),Object(M["a"])("do:add-list",{name:this.name,type:e})}},name:"add-list-modal"},J=K,Z=Object(x["a"])(J,z,V,!1,null,null,null),W=Z.exports,X=[],Y={components:{appHeader:S,addListModal:W,addMediumModal:W,loginModal:W,registerModal:W},data:function(){return{addListModal:{show:!1,error:""},addMediumModal:{show:!1,error:""},loginModal:{show:!1,error:""},registerModal:{show:!1,error:""},settingsModal:{show:!1,error:""},errorModal:{error:""},showLists:!0,showSettings:!1,showReleases:!1,settings:{}}},props:{name:String,lists:Array,news:Array,columns:Array,media:Array,externalUser:Array},mounted:function(){var e=this;console.log(this.$data),console.log(this),Object(M["b"])("select:list",function(t,n,r){return e.selectList(t,n,r)})},methods:{selectList:function(e,t,n){if(this.showLists)if(n){var r=this.allLists.find(function(n){return n.id===e&&n.external===t});r.show=!r.show}else{var s=!0,o=!1,a=void 0;try{for(var u,d=i()(this.allLists);!(s=(u=d.next()).done);s=!0){var l=u.value;l.show=l.id===e&&l.external===t&&!l.show}}catch(c){o=!0,a=c}finally{try{s||null==d.return||d.return()}finally{if(o)throw a}}}}},computed:{loggedIn:function(){return!!this.name},allLists:function(){var e=this.externalUser.flatMap(function(e){return e.lists});return[].concat(Object(a["a"])(this.lists),Object(a["a"])(e))},displayMedia:function(){var e,t=this,n=this.allLists.filter(function(e){return e.show}).flatMap(function(e){return e.items}),r=Object(a["a"])(new m.a(n)),i=[];(r=r.map(function(e){var n=t.media.find(function(t){return t.id===e});return n||i.push(e),n}).filter(function(e){return null!=e}),i=i.filter(function(e){return!X.some(function(t){return t===e})}),i.length)&&((e=X).push.apply(e,Object(a["a"])(i)),F.getMedia(i).then(function(e){Object(M["a"])("append:media",e),X=X.filter(function(t){return o()(e)?!e.some(function(e){return e.id===t}):e.id!==t})}).catch(function(e){return(t.errorModal.error=String(e))&&console.log(e)}));return r}}},Q=Y,$=Object(x["a"])(Q,f,h,!1,null,null,null),ee=$.exports,te=n("85fe"),ne=n("2d7d"),re=n.n(ne),ie=n("d225"),se=n("b0b4"),oe=function(){function e(){Object(ie["a"])(this,e),this.offline=!1,this.started=null,this.eventMap=new re.a}return Object(se["a"])(e,[{key:"startPush",value:function(){var e=this;return this.started=new _.a(function(t){if(e.offline)throw Error("please verify that server is online");e.socket=new WebSocket("ws://localhost:3000/"),e.socket.onmessage=function(t){return e.pushed(t)},e.socket.onopen=function(){return t()}})}},{key:"push",value:function(e){var t=this;if(!this.socket||!this.started)throw Error("webSocket is not active while trying to send message");this.started.then(function(){return t.socket&&t.socket.send(N()(e))})}},{key:"pushed",value:function(e){var t,n=this;try{t=JSON.parse(e.data)}catch(a){return}if(t)for(var r=R()(t),i=0;i<r.length;i++){var s=r[i];if(ue.any(s)){var o=function(){var e=t[s];console.log("dispatched ",s,e);var r=n.eventMap.get(s);if(!r)return"continue";r.forEach(function(t){return t(e)})}();if("continue"===o)continue}}}},{key:"addEventListener",value:function(e,t){if(!ue.any(e))throw Error("unknown event: "+e);if("function"!==typeof t)throw Error("no callback provided!");var n=this.eventMap.get(e);n||this.eventMap.set(e,n=[]),n.push(t)}},{key:"close",value:function(){this.socket&&this.socket.close(),this.socket=void 0}}]),e}(),ae=new oe,ue={ADD:"add",DELETE:"remove",UPDATE:"update",NEWS:"news",any:function(e){for(var t=R()(this),n=0;n<t.length;n++){var r=t[n],i=this[r];if(i===e&&"function"!==typeof i)return!0}return!1}};var de=function(){var e=[],t=!1;function n(){t||(t=!0,window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,66))}function r(){e.forEach(function(e){return e()}),t=!1}return{add:function(t){e.length||window.addEventListener("resize",n),t&&e.push(t)}}}();u["a"].config.devtools=!0,u["a"].use(te["a"]);var le={get media(){return ce.user.media},set media(e){ce.user.media=e},get columns(){return ce.user.columns},set columns(e){ce.user.columns=e},get lists(){return ce.user.lists},set lists(e){ce.user.lists=e},get session(){return ce.session},set session(e){ce.session=e},get uuid(){return ce.uuid},set uuid(e){ce.uuid=e},get name(){return ce.user.name},set name(e){ce.user.name=e},get externalUser(){return ce.user.externalUser},set externalUser(e){ce.user.externalUser=e},get news(){return ce.user.news},set news(e){ce.user.news=e},clear:function(){return this.name="",this.uuid="",this.session="",this.lists=[],this.media=[],this.externalUser=[],this},setName:function(e){return this.name=e,this},setId:function(e){return this.uuid=e,this},setSession:function(e){return this.session=e,this},pushExternalUser:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(e){return e.lists.forEach(function(e){e.show=!1,e.external=!0})}),(e=this.externalUser).push.apply(e,n),this},deleteExternalUser:function(e){var t=this.externalUser.findIndex(function(t){return t.uuid===e});t<0||this.externalUser.splice(t,1)},addMedium:function(){var e;return(e=this.media).push.apply(e,arguments),this},editMedium:function(e){return console.log("edited"),this},deleteMedium:function(e){var t=this.media.findIndex(function(t){return t.id===e});if(t<0)throw Error("invalid mediumId");return this.media.splice(t,1),this.lists.forEach(function(t){var n=t.items.findIndex(function(t){return t===e});n>=0&&t.items.splice(n,1)}),this},addList:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){t.show=!1,t.external=!1,e.lists.push(t)}),this},deleteList:function(e){var t=this.lists.findIndex(function(t){return t.id===e});if(t<0)throw Error("invalid mediumId");return this.lists.splice(t,1),this},addNews:function(e){var t=this.news;e=e.filter(function(e){return!t.find(function(t){return t.id===e.id})}).map(function(e){return(e.date=new Date(e.date))&&e}),e.length&&t.push.apply(t,Object(a["a"])(e))}},ce=new u["a"]({el:"#app",router:c,data:{addListModal:{show:!1,error:""},addMediumModal:{show:!1,error:""},loginModal:{show:!1,error:""},registerModal:{show:!1,error:""},settingsModal:{show:!1,error:""},errorModal:{error:""},loadingMedia:[],user:{lists:[],news:[],name:"",externalUser:[],media:[],settings:{},columns:[{name:"Title",prop:"title",show:!0},{name:"Author",prop:"author",show:!0},{name:"Artist",prop:"artist",show:!0}]},readNews:[],newReadNews:[],session:"",uuid:""},render:function(e){return e(ee,{props:this.user})},mounted:function(){var e=this;Object(M["b"])("open:register",function(){return e.registerModal.show=!0}),Object(M["b"])("do:register",function(t){return e.register(t)}),Object(M["b"])("open:login",function(){return e.loginModal.show=!0}),Object(M["b"])("do:login",function(t){return e.login(t)}),Object(M["b"])("do:logout",function(){return e.logout()}),Object(M["b"])("open:add-medium",function(){return e.addMediumModal.show=!0}),Object(M["b"])("open:medium",function(t){return e.openMedium(t)}),Object(M["b"])("add:medium",function(t){return e.addMedium(t)}),Object(M["b"])("edit:medium",function(t){return e.editMedium(t)}),Object(M["b"])("delete:medium",function(t){return e.deleteMedium(t)}),Object(M["b"])("open:add-list",function(){return e.addListModal.show=!0}),Object(M["b"])("add:list",function(t){return e.addList(t)}),Object(M["b"])("delete:list",function(t){return e.deleteList(t)}),Object(M["b"])("add:externalUser",function(t){return e.addExternalUser(t)}),Object(M["b"])("delete:externalUser",function(t){return e.deleteExternalUser(t)}),Object(M["b"])("refresh:externalUser",function(t){return e.refreshExternalUser(t)}),Object(M["b"])("do:settings",function(t){return e.changeSettings(t)}),Object(M["b"])("get:news",function(t){return e.loadNews(t)}),Object(M["b"])("read:news",function(t){return e.markReadNews(t)}),Object(M["b"])("append:media",function(e){o()(e)?le.addMedium.apply(le,Object(a["a"])(e)):le.addMedium(e)}),Object(M["b"])("reset:modal",function(){return e.closeModal()}),de.add(function(){return Object(M["a"])("window:resize")}),F.user=le,ae.addEventListener(ue.ADD,function(t){return e.processAddEvent(t)}),ae.addEventListener(ue.DELETE,function(t){return e.processDeleteEvent(t)}),ae.addEventListener(ue.UPDATE,function(t){return e.processUpdateEvent(t)}),ae.addEventListener(ue.NEWS,function(e){return le.addNews(e)}),this.loginState(),this.sendPeriodicData()},methods:{processDeleteEvent:function(e){e.items&&e.items.forEach(function(e){var t;if(t=e.external?le.externalUser.flatMap(function(e){return e.lists}).find(function(t){return t.id===e.listId}):le.lists.find(function(t){return t.id===e.listId}),t){var n=t.items.indexOf(e.mediumId);n<0||t.items.splice(n,1)}}),e.externalList&&e.externalList.forEach(function(e){var t=!0,n=!1,r=void 0;try{for(var s,o=i()(le.externalUser);!(t=(s=o.next()).done);t=!0){var a=s.value,u=a.lists.findIndex(function(t){return t.id===e});if(!(u<0)){a.lists.splice(u,1);break}}}catch(d){n=!0,r=d}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}),console.log(e)},processUpdateEvent:function(e){e.lists&&e.lists.forEach(function(e){if(e.external){var t=le.externalUser.flatMap(function(e){return e.lists}).find(function(t){return t.id===e.listId});e.name&&t&&(t.name=e.name)}else{var n=le.lists.find(function(t){return t.id===e.id});e.name&&n&&(n.name=e.name)}}),console.log(e)},processAddEvent:function(e){e.items&&e.items.forEach(function(e){var t;t=e.external?le.externalUser.flatMap(function(e){return e.lists}).find(function(t){return t.id===e.listId}):le.lists.find(function(t){return t.id===e.listId}),t&&t.items.push(e.mediumId)}),e.externalList&&e.externalList.forEach(function(e){var t=!0,n=!1,r=void 0;try{for(var s,o=i()(le.externalUser);!(t=(s=o.next()).done);t=!0){var a=s.value;if(e.uuid===a.uuid&&!a.lists.find(function(t){return t.id===e.id})){a.lists.push(e);break}}}catch(u){n=!0,r=u}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}})},closeModal:function(){this.resetModal(this.loginModal),this.resetModal(this.registerModal),this.resetModal(this.settingsModal),this.resetModal(this.addListModal),this.resetModal(this.addMediumModal)},resetModal:function(e){e.show=!1,e.error=""},sendPeriodicData:function(){var e=this;this.newReadNews.length&&(ae.push({read:{news:this.newReadNews}}),this.newReadNews=[]),setTimeout(function(){return e.sendPeriodicData()},500)},loginState:function(){var e=this;this.loggedIn||F.isLoggedIn().then(function(t){if(e.loggedIn||!t)throw Error();e.setUser(t)}).catch(function(){return setTimeout(function(){return e.loginState()},5e3)})},login:function(e){var t=this;e.user?e.pw?F.login(e.user,e.pw).then(function(e){t.setUser(e),t.resetModal(t.loginModal)}).catch(function(e){return t.loginModal.error=String(e)}):this.loginModal.error="Password is missing":this.loginModal.error="Username is missing"},register:function(e){var t=this;e.user?e.pw?e.pwRepeat?e.pwRepeat!==e.pw?this.registerModal.error="Repeated Password is not password":F.register(e.user,e.pw,e.pwRepeat).then(function(e){t.setUser(e),t.resetModal(t.registerModal)}).catch(function(e){return t.registerModal.error=String(e)}):this.registerModal.error="Password was not repeated":this.registerModal.error="Password is missing":this.registerModal.error="Username is missing"},addExternalUser:function(e){e.identifier?e.pwd?F.addExternalUser(e).then(function(e){return le.pushExternalUser(e)}).catch(function(e){return Object(M["a"])("error:add:externalUser",String(e))}):Object(M["a"])("error:add:externalUser","Password is missing!"):Object(M["a"])("error:add:externalUser","Identifier is missing!")},deleteExternalUser:function(e){e?F.deleteExternalUser(e).then(function(){return le.deleteExternalUser(e)}).catch(function(e){return console.log(e)}):console.error("cannot delete externalUser without data")},refreshExternalUser:function(e){e?ae.push({refresh:{externalUuid:e}}):console.error("cannot refresh externalUser without data")},setUser:function(e){var t,n;return(t=(n=le.clear().setName(e.name).setId(e.uuid).setSession(e.session)).addList.apply(n,Object(a["a"])(e.lists))).pushExternalUser.apply(t,Object(a["a"])(e.externalUser))},logout:function(){var e=this;F.logout().then(function(t){le.clear(),t||(e.errorModal.error="An error occurred while logging out")}).catch(function(t){return e.errorModal.error=String(t)})},openMedium:function(e){console.log(e)},addMedium:function(e){var t=this;e.title?e.type?F.createMedium(e).then(function(e){le.addMedium(e),t.resetModal(t.addMediumModal)}).catch(function(e){return t.addMediumModal.error=String(e)}):this.addMediumModal.error="Missing type":this.addMediumModal.error="Missing title"},editMedium:function(e){if(null==e.id||!e.prop)throw Error();F.updateMedium(e).catch(console.log)},deleteMedium:function(e){if(null==e)throw Error();F.deleteMedium(e).then(function(){return Object(M["a"])("deletion",!1)}).catch(function(e){return console.log(e)})},addList:function(e){var t=this;e.name?e.type?F.createList(e).then(function(e){le.addList(e),t.resetModal(t.addListModal)}).catch(function(e){return t.addListModal.error=String(e)}):this.addListModal.error="Missing type":this.addListModal.error="Missing name"},deleteList:function(e){F.deleteList(e).then(function(){return console.log("success")}).catch(function(e){return console.log(e)})},changeSettings:function(e){},markReadNews:function(e){this.readNews.indexOf(e)<0&&(this.readNews.push(e),this.newReadNews.push(e))},loadNews:function(e){F.getNews(e.from,e.to).then(function(e){return le.addNews(e)}).catch(console.log)}},computed:{loggedIn:function(){return!!this.user.name}},watch:{loggedIn:function(e){var t=this;e?ae.startPush().then(function(){return ae.push({uuid:t.uuid})}).catch(console.log):(ae.close(),this.loginState())}}})},f5ef:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return o});n("cadf"),n("551c"),n("097d");var r=n("2b0e"),i=new r["a"]({});function s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.$emit.apply(i,[e].concat(n))}function o(e,t){i.$on(e,function(){return t.apply(void 0,arguments)})}}});
//# sourceMappingURL=app.5213d1cb.js.map